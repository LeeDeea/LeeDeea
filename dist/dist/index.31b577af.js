import{_ as B}from"./index.48ad47e4.js";import{o as I,b as T,F as Q,f as Z,e as E,g as ot,d as st,h as j,A as it,B as lt,p as ut,j as ct,r as X,k as Y}from"./vendor.674df8de.js";const ht={data(){return{data:[{path:"../src/assets/bg-rotate.gif",title:"canvas\u5236\u4F5C\u7684\u661F\u7A7A\u56FE"},{path:"../src/assets/bg-rotate2.gif",title:"canvas\u5236\u4F5C\u7684\u65CB\u8F6C\u65B9\u5757"}]}},methods:{move(t){let e=t.currentTarget,n=t.currentTarget.firstElementChild,r=t.clientX-e.offsetLeft-n.offsetWidth/2,a=t.clientY-e.offsetTop-n.offsetHeight/2;n.style.transform=`matrix3d(
        1,0,0,${.0015*(r/200)},
        0,1,0,${.0015*(a/200)},
        0,0,1,0,
        0,0,0,1)`},leave(t){let e=t.currentTarget.firstElementChild;e.style.transform=` matrix3d(
        1,0,0,0,
        0,1,0,0,
        0,0,1,0,
        0,0,0,1)`}}},ft={class:"content"},dt={class:"card"},pt=["src"];function mt(t,e,n,r,a,i){return I(),T("div",ft,[(I(!0),T(Q,null,Z(a.data,(c,m)=>(I(),T("div",{key:m,class:"card_warp",onMouseleave:e[0]||(e[0]=g=>i.leave(g)),onMousemove:e[1]||(e[1]=g=>i.move(g))},[E("div",dt,[E("img",{src:c.path,alt:""},null,8,pt),E("span",null,ot(c.title),1)])],32))),128))])}var yt=B(ht,[["render",mt],["__scopeId","data-v-1685fdba"]]);const vt=st({data(){return{list:[],timer:null,tagEle:null,paper:null,RADIUS:null,fallLength:null,tags:null,angleX:null,angleY:null,CX:null,CY:null}},methods:{init(){let t=document.querySelectorAll(".tag"),e=document.querySelector(".tagBall"),n=150,r=500,a=[],i=Math.PI/500,c=Math.PI/500,m=e.offsetWidth/2,g=e.offsetHeight/2;function S(){function p(){return parseInt(Math.random()*255)}for(let f=0;f<t.length;f++){let _=-1+(2*(f+1)-1)/t.length,o=Math.acos(_),l=o*Math.sqrt(t.length*Math.PI),v=n*Math.sin(o)*Math.cos(l),w=n*Math.sin(o)*Math.sin(l),$=n*Math.cos(o),C=new x(t[f],v,w,$);t[f].style.color=`rgb(${p()},${p()},${p()})`,a.push(C),C.move()}}function d(){let p=Math.cos(i),f=Math.sin(i);a.forEach(function(){let _=this.y*p-this.z*f,o=this.z*p+this.y*f;this.y=_,this.z=o})}function u(){let p=Math.cos(c),f=Math.sin(c);a.forEach(function(){let _=this.x*p-this.z*f,o=this.z*p+this.x*f;this.x=_,this.z=o})}class x{constructor(f,_,o,l){this.ele=f,this.x=_,this.y=o,this.z=l}move(){let f=r/(r-this.z),_=(this.z+n)/(2*n),o=this.x+m-this.ele.offsetWidth/2+"px",l=this.y+g-this.ele.offsetHeight/2+"px",v=`translate(${o},${l}) scale(${f})`;this.ele.style.opacity=_+.5,this.ele.style.zIndex=parseInt(f*100),this.ele.style.transform=v,this.ele.style.webkitTransform=v}}a.forEach=function(p){for(let f=0;f<this.length;f++)p.call(this[f])};let z=this;function s(){d(),u(),a.forEach(function(){this.move()}),z.timer=requestAnimationFrame(s)}S(),s()}},created(){for(let t=0;t<20;t++)this.list.push("../src/assets/fluidicon.png")},mounted(){this.init()},beforeUnmount(){cancelAnimationFrame(this.timer),this.timer=null}}),gt={class:"content"},xt={class:"tagBall"},_t=j(" git"),wt=["src"],St=j("hub ");function zt(t,e,n,r,a,i){return I(),T("div",gt,[E("div",xt,[(I(!0),T(Q,null,Z(t.list,(c,m)=>(I(),T("div",{class:"tag",key:m},[_t,E("img",{src:c},null,8,wt),St]))),128))])])}var $t=B(vt,[["render",zt],["__scopeId","data-v-1ae8a4df"]]),Mt={value:function(){}};function tt(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new F(n)}function F(t){this._=t}function Ct(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}F.prototype=tt.prototype={constructor:F,on:function(t,e){var n=this._,r=Ct(t+"",n),a,i=-1,c=r.length;if(arguments.length<2){for(;++i<c;)if((a=(t=r[i]).type)&&(a=bt(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<c;)if(a=(t=r[i]).type)n[a]=G(n[a],t.name,e);else if(e==null)for(a in n)n[a]=G(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new F(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,i;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,i=r.length;a<i;++a)r[a].value.apply(e,n)}};function bt(t,e){for(var n=0,r=t.length,a;n<r;++n)if((a=t[n]).name===e)return a.value}function G(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=Mt,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var It=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dispatch:tt}),Tt=it(It),kt=Tt.dispatch,H=Math.PI/180,O=1<<11>>5,W=1<<11,Et=function(){var t=[256,256],e=At,n=Ot,r=qt,a=J,i=J,c=Ft,m=Wt,g=et,S=[],d=1/0,u=kt("word","end"),x=null,z=Math.random,s={},p=Yt;s.canvas=function(o){return arguments.length?(p=b(o),s):p},s.start=function(){var o=f(p()),l=Xt((t[0]>>5)*t[1]),v=null,w=S.length,$=-1,C=[],M=S.map(function(y,h){return y.text=e.call(this,y,h),y.font=n.call(this,y,h),y.style=a.call(this,y,h),y.weight=i.call(this,y,h),y.rotate=c.call(this,y,h),y.size=~~r.call(this,y,h),y.padding=m.call(this,y,h),y}).sort(function(y,h){return h.size-y.size});return x&&clearInterval(x),x=setInterval(k,0),k(),s;function k(){for(var y=Date.now();Date.now()-y<d&&++$<w&&x;){var h=M[$];h.x=t[0]*(z()+.5)>>1,h.y=t[1]*(z()+.5)>>1,Bt(o,h,M,$),h.hasText&&_(l,h,v)&&(C.push(h),u.call("word",s,h),v?Kt(v,h):v=[{x:h.x+h.x0,y:h.y+h.y0},{x:h.x+h.x1,y:h.y+h.y1}],h.x-=t[0]>>1,h.y-=t[1]>>1)}$>=w&&(s.stop(),u.call("end",s,C,v))}},s.stop=function(){return x&&(clearInterval(x),x=null),s};function f(o){o.width=o.height=1;var l=Math.sqrt(o.getContext("2d").getImageData(0,0,1,1).data.length>>2);o.width=(O<<5)/l,o.height=W/l;var v=o.getContext("2d");return v.fillStyle=v.strokeStyle="red",v.textAlign="center",{context:v,ratio:l}}function _(o,l,v){t[0],t[1];for(var w=l.x,$=l.y,C=Math.sqrt(t[0]*t[0]+t[1]*t[1]),M=g(t),k=z()<.5?1:-1,y=-k,h,D,K;(h=M(y+=k))&&(D=~~h[0],K=~~h[1],!(Math.min(Math.abs(D),Math.abs(K))>=C));)if(l.x=w+D,l.y=$+K,!(l.x+l.x0<0||l.y+l.y0<0||l.x+l.x1>t[0]||l.y+l.y1>t[1])&&(!v||!Dt(l,o,t[0]))&&(!v||Nt(l,v))){for(var nt=l.sprite,q=l.width>>5,R=t[0]>>5,L=l.x-(q<<4),U=L&127,rt=32-U,at=l.y1-l.y0,V=(l.y+l.y0)*R+(L>>5),N,P=0;P<at;P++){N=0;for(var A=0;A<=q;A++)o[V+A]|=N<<rt|(A<q?(N=nt[P*q+A])>>>U:0);V+=R}return delete l.sprite,!0}return!1}return s.timeInterval=function(o){return arguments.length?(d=o==null?1/0:o,s):d},s.words=function(o){return arguments.length?(S=o,s):S},s.size=function(o){return arguments.length?(t=[+o[0],+o[1]],s):t},s.font=function(o){return arguments.length?(n=b(o),s):n},s.fontStyle=function(o){return arguments.length?(a=b(o),s):a},s.fontWeight=function(o){return arguments.length?(i=b(o),s):i},s.rotate=function(o){return arguments.length?(c=b(o),s):c},s.text=function(o){return arguments.length?(e=b(o),s):e},s.spiral=function(o){return arguments.length?(g=Ht[o]||o,s):g},s.fontSize=function(o){return arguments.length?(r=b(o),s):r},s.padding=function(o){return arguments.length?(m=b(o),s):m},s.random=function(o){return arguments.length?(z=o,s):z},s.on=function(){var o=u.on.apply(u,arguments);return o===u?s:o},s};function At(t){return t.text}function Ot(){return"serif"}function J(){return"normal"}function qt(t){return Math.sqrt(t.value)}function Ft(){return(~~(Math.random()*6)-3)*30}function Wt(){return 1}function Bt(t,e,n,r){if(!e.sprite){var a=t.context,i=t.ratio;a.clearRect(0,0,(O<<5)/i,W/i);var c=0,m=0,g=0,S=n.length;for(--r;++r<S;){e=n[r],a.save(),a.font=e.style+" "+e.weight+" "+~~((e.size+1)/i)+"px "+e.font;var d=a.measureText(e.text+"m").width*i,u=e.size<<1;if(e.rotate){var x=Math.sin(e.rotate*H),z=Math.cos(e.rotate*H),s=d*z,p=d*x,f=u*z,_=u*x;d=Math.max(Math.abs(s+_),Math.abs(s-_))+31>>5<<5,u=~~Math.max(Math.abs(p+f),Math.abs(p-f))}else d=d+31>>5<<5;if(u>g&&(g=u),c+d>=O<<5&&(c=0,m+=g,g=0),m+u>=W)break;a.translate((c+(d>>1))/i,(m+(u>>1))/i),e.rotate&&a.rotate(e.rotate*H),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=d,e.height=u,e.xoff=c,e.yoff=m,e.x1=d>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,c+=d}for(var o=a.getImageData(0,0,(O<<5)/i,W/i).data,l=[];--r>=0;)if(e=n[r],!!e.hasText){for(var d=e.width,v=d>>5,u=e.y1-e.y0,w=0;w<u*v;w++)l[w]=0;if(c=e.xoff,c==null)return;m=e.yoff;for(var $=0,C=-1,M=0;M<u;M++){for(var w=0;w<d;w++){var k=v*M+(w>>5),y=o[(m+M)*(O<<5)+(c+w)<<2]?1<<31-w%32:0;l[k]|=y,$|=y}$?C=M:(e.y0++,u--,M--,m++)}e.y1=e.y0+C,e.sprite=l.slice(0,(e.y1-e.y0)*v)}}}function Dt(t,e,n){n>>=5;for(var r=t.sprite,a=t.width>>5,i=t.x-(a<<4),c=i&127,m=32-c,g=t.y1-t.y0,S=(t.y+t.y0)*n+(i>>5),d,u=0;u<g;u++){d=0;for(var x=0;x<=a;x++)if((d<<m|(x<a?(d=r[u*a+x])>>>c:0))&e[S+x])return!0;S+=n}return!1}function Kt(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function Nt(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function et(t){var e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Pt(t){var e=4,n=e*t[0]/t[1],r=0,a=0;return function(i){var c=i<0?-1:1;switch(Math.sqrt(1+4*c*i)-c&3){case 0:r+=n;break;case 1:a+=e;break;case 2:r-=n;break;default:a-=e;break}return[r,a]}}function Xt(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}function Yt(){return document.createElement("canvas")}function b(t){return typeof t=="function"?t:function(){return t}}var Ht={archimedean:et,rectangular:Pt};const Rt={props:{margin:{type:Object,default:{top:15,right:15,bottom:15,left:15}},padding:{type:Number,default:3},rotate:{type:Object,default:function(){return{from:0,to:0,numOfOrientation:0}}},spiral:{type:String,default:"archimedean"},fontScale:{type:String,default:"sqrt"},font:{type:String,default:"impact"},fontSize:{type:Array,default:function(){return[10,80]}},color:{type:[String,Array],default:"Category10"},data:{type:Array,default:[{name:"\u6D4B\u8BD51",value:10},{name:"\u6D4B\u8BD52",value:100},{name:"\u6D4B\u8BD53",value:23},{name:"\u6D4B\u8BD54",value:52},{name:"\u6D4B\u8BD55",value:3245},{name:"\u6D4B\u8BD56",value:345},{name:"\u6D4B\u8BD57",value:234},{name:"\u6D4B\u8BD58",value:54},{name:"\u6D4B\u8BD59",value:10},{name:"\u6D4B\u8BD510",value:100},{name:"\u6D4B\u8BD511",value:23},{name:"\u6D4B\u8BD512",value:3245},{name:"\u6D4B\u8BD513",value:52},{name:"\u6D4B\u8BD514",value:345},{name:"\u6D4B\u8BD515",value:234},{name:"\u6D4B\u8BD516",value:54}]},nameKey:{type:String,default:"name"},valueKey:{type:String,default:"value"},showTooltip:{type:Boolean,default:!0},wordClick:{type:Function,default:null}},data(){return{svgWidth:0,svgHeight:0}},computed:{size(){const{svgWidth:t,svgHeight:e}=this,{margin:n}=this,r=t-n.left-n.right,a=e-n.top-n.bottom;return{width:r,height:a}},words(){const{data:t,valueKey:e}=this;return t.sort(function(r,a){return parseFloat(a[e])-parseFloat(r[e])})}},watch:{words:{handler:function(t,e){this.update()},deep:!0}},mounted(){this.getSize(),this.chart=this.createChart(),this.renderChart()},beforeUnmount(){let t=document.getElementsByClassName("wordCloud")[0];for(let e of t.childNodes)e.remove()},methods:{onResize(){this.getSize()},getSize(){this.svgWidth=this.$el.clientWidth,this.svgHeight=this.$el.clientHeight},createChart(){const{margin:t}=this,{width:e,height:n}=this.size;return this.$d3.select(".wordCloud").append("svg").attr("width","100%").attr("height","100%").append("g").attr("width",e).attr("height",n).attr("class","chart").attr("transform","translate("+t.left+","+t.top+")")},setFontSizeScale(){const{fontSize:t,fontScale:e,words:n,valueKey:r}=this;switch(e){case"sqrt":this.fontSizeScale=this.$d3.scaleSqrt();break}this.fontSizeScale.range(t),n.length&&this.fontSizeScale.domain([+n[n.length-1][r]||1,+n[0][r]])},renderChart(){this.setFontSizeScale();const{spiral:t,padding:e,fontSizeScale:n,font:r,words:a,nameKey:i,valueKey:c}=this,{width:m,height:g}=this.size,S=this,{a:d,b:u,c:x}=function(){const{from:p,to:f,numOfOrientation:_}=S.rotate,o=(Math.abs(p)+Math.abs(f))/(_-1)||1;return{a:_,b:p/o,c:o}}(),s=Et().size([m,g]).words(a).fontSize(p=>n(p[c])).text(p=>p[i]).font(r).padding(e).rotate(()=>(~~(Math.random()*d)+u)*x).spiral(t).on("end",this.draw);this.layout=s,s.start()},getColorScale(t){return typeof t=="string"?this.$d3.scaleOrdinal(lt["scheme"+t]):this.$d3.scaleOrdinal(t)},draw(t){const{layout:e,chart:n,color:r,nameKey:a,valueKey:i,showTooltip:c,wordClick:m}=this,g=this.getColorScale(r),S=n.append("g").attr("transform","translate("+e.size()[0]/2+","+e.size()[1]/2+")");this.$d3.select("body").append("div").attr("class","tooltip").style("opacity",0),S.selectAll("text").data(t).enter().append("text").style("font-size",u=>u.size+"px").style("font-family",u=>u.font).style("fill",(u,x)=>g(x)).attr("class","text").attr("text-anchor","middle").transition().duration(500).attr("transform",u=>"translate("+[u.x,u.y]+")rotate("+u.rotate+")").text(u=>u.text)},update(){const{words:t,layout:e,fontSizeScale:n,chart:r,valueKey:a}=this,{width:i,height:c}=this.size;t.length&&n.domain([+t[t.length-1][a]||1,+t[0][a]]),r.select("g").remove(),e.stop().size([i,c]).words(t).start()}}},Lt=t=>(ut("data-v-09c88fc8"),t=t(),ct(),t),Ut={class:"content"},Vt=Lt(()=>E("div",{class:"wordCloud"},null,-1)),Gt=[Vt];function Jt(t,e,n,r,a,i){return I(),T("div",Ut,Gt)}var Qt=B(Rt,[["render",Jt],["__scopeId","data-v-09c88fc8"]]);const Zt={components:{Card:yt,TitleCloud:$t,WordCloud:Qt},methods:{init(){}},mounted(){this.init()}},jt={class:"warp"};function te(t,e,n,r,a,i){const c=X("card"),m=X("word-cloud"),g=X("title-cloud");return I(),T("div",jt,[Y(c),Y(m),Y(g)])}var re=B(Zt,[["render",te],["__scopeId","data-v-41a3154b"]]);export{re as default};
